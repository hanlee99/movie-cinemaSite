<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${movie.title} + ' - 오늘의영화'">영화 상세</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" />
    <link rel="stylesheet" th:href="@{/css/main.css}">
</head>
<body class="min-h-screen flex flex-col bg-gray-50">

<header th:replace="~{fragments/components/header :: site-header}"></header>

<main class="flex-grow py-8">
    <div class="max-w-4xl mx-auto px-4">
        
        <!-- 홈으로 돌아가기 버튼 -->
        <div class="mb-6">
            <a href="/" class="inline-flex items-center text-blue-600 hover:text-blue-800">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
                </svg>
                홈으로 돌아가기
            </a>
        </div>

        <!-- 영화 상세 정보 카드 -->
        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <div class="md:flex">
                <!-- 포스터 이미지 -->
                <div class="md:w-1/3 p-6 flex items-center justify-center bg-gray-100">
                    <div class="aspect-[2/3] w-full max-w-xs bg-gray-200 rounded-lg overflow-hidden shadow-md">
                        <img th:if="${movie.poster != null and !movie.poster.isEmpty()}"
                             th:src="${movie.poster}"
                             th:alt="${movie.title}"
                             class="w-full h-full object-cover">
                        <img th:unless="${movie.poster != null and !movie.poster.isEmpty()}"
                             th:src="@{/images/irani12.png}"
                             th:alt="${movie.title}"
                             class="w-full h-full object-cover opacity-50">
                    </div>
                </div>

                <!-- 영화 정보 -->
                <div class="md:w-2/3 p-6">
                    <!-- 제목 -->
                    <h1 class="text-3xl font-bold text-gray-900 mb-4" th:text="${movie.title}">영화 제목</h1>

                    <!-- 기본 정보 -->
                    <div class="space-y-2 mb-6">
                        <div class="flex items-center text-gray-600">
                            <span class="font-semibold w-20">장르</span>
                            <span th:text="${movie.genre ?: '정보 없음'}">-</span>
                        </div>
                        <div class="flex items-center text-gray-600">
                            <span class="font-semibold w-20">상영시간</span>
                            <span th:text="${movie.runtime != null ? movie.runtime + '분' : '정보 없음'}">-</span>
                        </div>
                        <div class="flex items-center text-gray-600">
                            <span class="font-semibold w-20">등급</span>
                            <span th:text="${movie.rating ?: '정보 없음'}">-</span>
                        </div>
                        <div class="flex items-center text-gray-600">
                            <span class="font-semibold w-20">개봉일</span>
                            <span th:if="${movie.repRlsDate != null and movie.repRlsDate.length() == 8}"
                                  th:text="${#strings.substring(movie.repRlsDate, 0, 4) + '-' + #strings.substring(movie.repRlsDate, 4, 6) + '-' + #strings.substring(movie.repRlsDate, 6, 8)}">-</span>
                            <span th:unless="${movie.repRlsDate != null and movie.repRlsDate.length() == 8}"
                                  th:text="${movie.repRlsDate ?: '정보 없음'}">-</span>
                        </div>
                    </div>

                    <!-- 감독 -->
                    <div class="mb-4" th:if="${movie.people != null}">
                        <h3 class="font-semibold text-gray-700 mb-2">감독</h3>
                        <div class="flex flex-wrap gap-2">
                            <span th:each="person : ${movie.people}" 
                                  th:if="${person.roleGroup == '감독'}"
                                  class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm"
                                  th:text="${person.person.name}">감독명</span>
                            <span th:if="${#lists.isEmpty(movie.people.?[roleGroup == '감독'])}" 
                                  class="text-gray-500 text-sm">정보 없음</span>
                        </div>
                    </div>

                    <!-- 배우 (최대 5명) -->
                    <div class="mb-4" th:if="${movie.people != null}">
                        <h3 class="font-semibold text-gray-700 mb-2">출연</h3>
                        <div class="flex flex-wrap gap-2">
                            <span th:each="person, iterStat : ${movie.people}" 
                                  th:if="${person.roleGroup == '출연' and iterStat.index < 5}"
                                  class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm"
                                  th:text="${person.person.name}">배우명</span>
                            <span th:if="${#lists.isEmpty(movie.people.?[roleGroup == '출연'])}" 
                                  class="text-gray-500 text-sm">정보 없음</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 줄거리 -->
            <div class="px-6 pb-6 pt-4 border-t border-gray-200">
                <h2 class="text-xl font-bold text-gray-900 mb-3">줄거리</h2>
                <p class="text-gray-700 leading-relaxed whitespace-pre-line" 
                   th:text="${movie.plot != null and !movie.plot.isEmpty() ? movie.plot : '줄거리 정보가 없습니다.'}">
                    줄거리 내용
                </p>
            </div>
        </div>

    </div>
</main>

<footer th:replace="~{fragments/components/footer :: site-footer}"></footer>

</body>
</html>

