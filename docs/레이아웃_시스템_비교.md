# 📐 Thymeleaf 레이아웃 시스템 비교

## 현재 상황
- ❌ Thymeleaf Layout Dialect 미설치
- ✅ Fragment 기반 접근 사용 중 (`th:replace`, `th:insert`)

---

## 🎯 두 가지 접근 방식 비교

### 방법 1: Thymeleaf Layout Dialect (라이브러리 사용)

#### 개념
- **Decorate 패턴**: 페이지가 레이아웃을 "장식"하는 방식
- SiteMesh와 유사한 개념

#### 장점
✅ **명확한 역할 분리**: 레이아웃과 콘텐츠가 완전히 분리  
✅ **유연성**: 여러 레이아웃 사용 가능 (base, admin, user 등)  
✅ **재사용성**: 레이아웃 변경 시 한 곳만 수정  
✅ **표준 방식**: 많은 프로젝트에서 사용하는 패턴  

#### 단점
❌ **의존성 추가**: 라이브러리 추가 필요  
❌ **학습 곡선**: 새로운 문법 학습 필요  
❌ **Spring Boot 3.x 호환성**: 최신 버전 확인 필요  

#### 사용 예시

```html
<!-- layout/base.html (레이아웃 템플릿) -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title layout:title-pattern="$CONTENT_TITLE - $LAYOUT_TITLE">오늘의영화</title>
    
    <!-- 공통 CSS -->
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" layout:fragment="styles"></link>
</head>
<body>
    <header th:replace="~{fragments/components/header :: site-header}"></header>
    
    <main layout:fragment="content">
        <!-- 기본 콘텐츠 (페이지에서 덮어씀) -->
    </main>
    
    <footer th:replace="~{fragments/components/footer :: site-footer}"></footer>
    
    <!-- 공통 JS -->
    <script th:src="@{/js/app.js}"></script>
    <script layout:fragment="scripts"></script>
</body>
</html>
```

```html
<!-- pages/home.html (콘텐츠 페이지) -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
    <title>홈</title>
    
    <!-- 페이지별 CSS -->
    <link rel="stylesheet" layout:fragment="styles" th:href="@{/css/sections/boxoffice.css}"></link>
</head>
<body>
    <main layout:fragment="content">
        <div class="max-w-6xl mx-auto px-4">
            <section id="boxoffice" th:insert="~{fragments/sections/boxoffice :: boxoffice}"></section>
            <section th:insert="~{fragments/sections/cinema :: cinema}"></section>
        </div>
    </main>
    
    <!-- 페이지별 JS -->
    <script layout:fragment="scripts">
        <script th:src="@{/js/sections/boxoffice.js}"></script>
    </script>
</body>
</html>
```

---

### 방법 2: Fragment 기반 접근 (현재 방식 개선)

#### 개념
- **Fragment 조합**: 여러 Fragment를 조합하여 페이지 구성
- 추가 라이브러리 불필요

#### 장점
✅ **의존성 없음**: 추가 라이브러리 불필요  
✅ **가벼움**: 순수 Thymeleaf만 사용  
✅ **유연성**: Fragment를 자유롭게 조합  
✅ **학습 곡선 낮음**: 기존 방식 확장  

#### 단점
❌ **중복 코드**: 각 페이지마다 head 태그 반복 가능  
❌ **일관성 관리**: 수동으로 일관성 유지 필요  

#### 개선된 사용 예시

```html
<!-- fragments/layout/base-head.html -->
<head th:fragment="base-head(title, styles)">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title}">오늘의영화</title>
    
    <!-- 공통 CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    
    <!-- 페이지별 CSS -->
    <th:block th:if="${styles}" th:each="style : ${styles}">
        <link rel="stylesheet" th:href="@{${style}}">
    </th:block>
</head>
```

```html
<!-- fragments/layout/base-body.html -->
<body th:fragment="base-body(content)">
    <header th:replace="~{fragments/components/header :: site-header}"></header>
    
    <main class="flex-grow">
        <th:block th:replace="${content}"></th:block>
    </main>
    
    <footer th:replace="~{fragments/components/footer :: site-footer}"></footer>
    
    <!-- 공통 JS -->
    <script th:src="@{/js/app.js}"></script>
</body>
```

```html
<!-- pages/home.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout/base-head :: base-head('홈', ${['/css/sections/boxoffice.css', '/css/sections/cinema.css']})}"></head>
<body th:replace="~{fragments/layout/base-body :: base-body(~{::content})}">
    <th:block th:fragment="content">
        <div class="max-w-6xl mx-auto px-4">
            <section id="boxoffice" th:insert="~{fragments/sections/boxoffice :: boxoffice}"></section>
            <section th:insert="~{fragments/sections/cinema :: cinema}"></section>
        </div>
    </th:block>
</body>
</html>
```

---

## 🤔 어떤 방식을 선택할까?

### Thymeleaf Layout Dialect를 선택하는 경우
- ✅ **여러 레이아웃**이 필요한 경우 (admin, user, public 등)
- ✅ **표준 패턴**을 선호하는 경우
- ✅ **대규모 프로젝트**에서 일관성 관리가 중요한 경우

### Fragment 기반을 선택하는 경우
- ✅ **의존성을 최소화**하고 싶은 경우
- ✅ **간단한 프로젝트**에서 빠르게 구현하고 싶은 경우
- ✅ **기존 코드**를 최소한으로 변경하고 싶은 경우

---

## 💡 추천: 하이브리드 접근

### 제안: Fragment 기반 + 구조화

현재 프로젝트 상황을 고려하면, **Fragment 기반 접근을 개선**하는 것이 좋습니다:

1. **의존성 추가 없음**: 빌드 시간 단축
2. **기존 코드와 호환**: 점진적 마이그레이션 가능
3. **충분한 유연성**: Fragment로 모든 요구사항 충족 가능

#### 개선된 구조

```
templates/
├── fragments/
│   ├── layout/
│   │   ├── base-head.html      # 공통 head
│   │   ├── base-body.html      # 공통 body 구조
│   │   └── page-wrapper.html   # 전체 페이지 래퍼
│   ├── components/
│   │   ├── header.html
│   │   └── footer.html
│   └── sections/
│       ├── boxoffice.html
│       └── cinema.html
└── pages/
    ├── home.html               # base-head + base-body 사용
    ├── detail.html
    └── search.html
```

---

## 🚀 구현 예시 (Fragment 기반 개선)

### 1. 레이아웃 Fragment 생성

```html
<!-- fragments/layout/page-wrapper.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" 
      th:fragment="page-wrapper(title, styles, scripts, content)">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title}">오늘의영화</title>
    
    <!-- 공통 리소스 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" th:href="@{/css/main.css}">
    
    <!-- 페이지별 CSS -->
    <th:block th:if="${styles != null}">
        <th:block th:each="style : ${styles}">
            <link rel="stylesheet" th:href="@{${style}}">
        </th:block>
    </th:block>
</head>
<body class="min-h-screen flex flex-col">
    <header th:replace="~{fragments/components/header :: site-header}"></header>
    
    <main class="flex-grow">
        <th:block th:replace="${content}"></th:block>
    </main>
    
    <footer th:replace="~{fragments/components/footer :: site-footer}"></footer>
    
    <!-- 공통 JS -->
    <script th:src="@{/js/app.js}" type="module" defer></script>
    
    <!-- 페이지별 JS -->
    <th:block th:if="${scripts != null}">
        <th:block th:each="script : ${scripts}">
            <script th:src="@{${script}}" type="module" defer></script>
        </th:block>
    </th:block>
</body>
</html>
```

### 2. 페이지에서 사용

```html
<!-- home.html -->
<html xmlns:th="http://www.thymeleaf.org"
      th:replace="~{fragments/layout/page-wrapper :: page-wrapper(
        '홈 - 오늘의영화',
        ${['/css/sections/boxoffice.css', '/css/sections/cinema.css']},
        ${['/js/sections/boxoffice.js']},
        ~{::content}
      )}">
<th:block th:fragment="content">
    <div class="max-w-6xl mx-auto px-4">
        <section id="boxoffice" th:insert="~{fragments/sections/boxoffice :: boxoffice}"></section>
        <section th:insert="~{fragments/sections/cinema :: cinema}"></section>
    </div>
</th:block>
</html>
```

---

## 📊 최종 비교표

| 항목 | Layout Dialect | Fragment 기반 (개선) |
|------|---------------|---------------------|
| 의존성 | 필요 | 불필요 |
| 학습 곡선 | 중간 | 낮음 |
| 코드 중복 | 없음 | 최소화 가능 |
| 유연성 | 높음 | 높음 |
| 유지보수 | 쉬움 | 쉬움 |
| Spring Boot 3.x | 호환성 확인 필요 | 완벽 호환 |

---

## 🎯 결론 및 추천

**현재 프로젝트에는 Fragment 기반 개선 방식을 추천합니다:**

1. ✅ **의존성 추가 없음**: 빌드 시간 단축
2. ✅ **기존 코드와 호환**: 점진적 마이그레이션
3. ✅ **충분한 기능**: 모든 요구사항 충족 가능
4. ✅ **유지보수 용이**: 구조만 개선하면 됨

**만약 나중에 더 복잡한 레이아웃이 필요하다면**, 그때 Layout Dialect로 전환하는 것도 가능합니다.

---

**작성일**: 2025-01-XX  
**버전**: 1.0


